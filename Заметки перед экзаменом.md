# Важная информация

## СуммаПоДокументу
ПередПроведением документа актуализировать сумму по документу (СуммаПоДокументу = СписокНоменклатуры.Итог("Сумма"))

*Не обязательно, но желательно сделать при изменении кол-ва и цены пересчет по сумме. Также ПослеУдаления и НачалоРедактирования (с усл Копирование).*

## Блокировка данных
Нужна для корректной проверки остатков (ТОЛЬКО ЕСЛИ НУЖНО ПРОВЕРИТЬ ОСТАТОК).

Расходная накладная -
Старая (Записать пустое, поставить флаг, описать блокировку по измерениям, 2 пакета[втТЧТовары, выборка по остатку]){МоментВремени()}

Новая (1 запрос - именно ВЫБОРКА ТЧ, создание вт, МенеджерВТ, записываем движения, блокируем движения, 
2 запрос - остатки с условием Остаток < 0){Новый Граница(МоментВремени(), ВидГраницы.Включая)}

# Очевидные, но важные моменты
## Работа с БД
*При соединении таблиц - правая таблица значению проставить ЕСТЬNULL(Поле,0)*

**ВАЖНО при выводе сообщения выводятся либо ПРЕДСТАВЛЕНИЯ либо НАИМЕНОВАНИЕ, чтобы не использовать ссылку(запрос в бд)**

## Себестоимость
### Средняя
Средняя себестоимость считается: (Кол-во списания * Сумму сумм всей номенклатуры / общее кол-во номенклатуры)

Добавление схлопования в приходную и в движения (добавить ресурс "Себестоимость")

В расходной расчет себестоимости с проверкой последнего списания (Выборка.Количество = Выборка.КоличествоОстаток) И по формуле выше.

### FIFO/LIFO (ПАРТИИ)
Разница в добавлении УБЫВ в запрос.

Добавить измерение Партия (соотв. добавить в приходную Ссылку на док в партию)

Добавление нового регистра сведений (только ресурс МетодСписанияСебестоимости)

При запросе нужны ИТОГИ для группировки по номенклатуре с МАКС(Кол-во), СУММА(Остаток)

При обработке детальных записей в случае если Отказа нет Берется минимальное кол-во для списания (Лучше прогнать это несколько раз видос 3)

## План видов характеристик
В некоторых задачах попадаются условия, связанные с дополнительными характеристиками товаров, заказов и т.п. Для реализации данного условия необходимо:
- Создать Спр: *ДополнительныеЗначенияХарактеристик*. Установить владельца как ПВХ:*СвойстваОбъектов*;
- В ПВХ:*СвойстваОбъектов* нужно назначить типы значения характеристик (включая) для предопределенных (указанные в задаче) характеристик;
- В ПВХ:*СвойстваОбъектов* указать в качестве дополнительных значений Спр: *ДополнительныеЗначенияХарактеристик*.
- Создать РегистрСведений: *ЗначенияСвойств* с измерениями нужного объекта *Объект* и *Свойство* и ресурсом *Значение*;
- В регистре сведений *Свойство* - ПВХ:*СвойстваОбъектов*, а *Значение* - Характеристика ПВХ:*СвойстваОбъектов*;
- В регистре сведений *Значение* настроить по полям *Связи параметров выбора* (для отбора по свойству) и *Связь по типу* (для автоуказания типа по свойству)
Справочник нужен для того, чтобы пользователь самостоятельно мог заполнить дополнительные характеристики в произвольном порядке.

Регистр сведений нужен для того, чтобы характеристика объекта была взята актуальная только одна в рамка указанных измерений.