# Логика решения ОУ билетов
## Стандартный приход/расход с расчетом себестоимости
### Услуга

**Во всех билетах присутствует вид Услуга, следует учитывать её в номенклатуре.**

Необходимо создать её в Спр:Номенклатура с обязательным заполнением и ссылкой на перечисление.

В приходной накладной ограничить выбор на услугу (нельзя привезти услугу).

В расходной накладной тоже не забыть про движения ТОЛЬКО по Товарам.

### Параметры задачи
Могут использоваться разные дополнения/вариации к задаче:
1. ведение складского учета;
2. ведение партионного учета для расчета себестоимости;
3. дополнительные регистры для отчетности;
4. условия на приоритетность складов;
5. разные валюты;
6. разрезы в рамках ПВХ;
7. скоропортящиеся продукты;
8. доп. затраты.

### Основные действия
Основные действия с объектами и логикой:
- схлопование строк в ТЧ по Номенклатуре;
- при новой методике выборку второго пакета запроса вывести с учетом уже списаных товаров
- при старой методике сравнить кол-во запрашиваемых товаров и кол-во остатка (смотреть условия задачи для определения разрезов)

#### Ведение складского учета

Последовательность действий:
1. Добавление Спр:Склад.
2. Добавление реквизита Склад в необходимые док-ты (Приходная, Расходная).
3. В зависимости от условий вставить в шапку док-а или в ТЧ реквизит Склад.
4. Добавление Склада в регистр накоплений ОстаткиНоменклатуры в качестве измерения.
5. При формировании движений в Приходной накладной учесть Склад.
6. При формировании движений в Расходной накладной проверить наличие товаров в разрезе Склада И Номенклатуры (Не забыть про блокировку и какой метод использовать).
7. Затестить.

#### Ведение партионного учета для расчета себестоимости
Подразумевается, что при расчете себестоимости необходимо создавать новый разрез в регистре ОстаткиНоменклатуры (Измерение:Партия - док. Приходная).

Для проверки общего кол-ва товара по всему "Предприятию" необходимо использовать итоги и выборку ПоГруппировкам

**Важная пометка: При формировании второго пакета запроса кол-во товара по втТЧТовары НЕ НУЖНО СУММИРОВАТЬ. Для кол-ва втТЧТовары использовать фукуцию МАКС(), а для остатков СУММА().**

Последовательность действий:
1. Добавление реквизита Партия в необходимые док-ты (Расходная).
2. В зависимости от условий вставить в шапку док-а или в ТЧ реквизит Партия (Расходная).
3. При формировании движений в Приходной накладной учесть Партию как Ссылка.
4. При формировании движений в Расходной накладной проверить наличие товаров по условиям задачи (в разрезе Партий или в сумме по всем/всему складам/складу). Также не забыть про блокировку и какой метод использовать.
5. Затестить.

#### Дополнительные регистры для отчетности
В задачах необходимо обращать внимание на отчет, который нужно построить в результате реализованного кода. Такие задачи попадаются в *ОУ 2*

## Приход/расход с взаиморасчетами и валютами



## Стеллажи/готовые блюда
*Стеллажи есть только в ОУ 6. Готовые блюда в ОУ 10*

## Заказы покупателей
*Заказы есть только в ОУ 12.*

Последовательность действий 1-го варианта:
1. Для контроля Заказа необходимо создать регистр накоплений ЗаказПокупателя с видом: Остатки.
2. Создать док ЗаказПокупателя, где будет заполнятся только Номенклатура и Кол-во.
3. В Приходной и Расходной в зависимости от условия задачи засунуть ЗаказПокупателя как ссылку на док.
4. При формировании движений в Приходной накладной нужно по новой методике добавить записи в Остатки, сравнить Обороты Заказа и Обороты Остатков.
5. При формировании движений в Расходной накладной нужно по новой методике добавить записи в Заказы, сравнить остатки по заказу.
6. Затем в Расходной накладной нужно по старой методике сравнить ОстаткиНоменклатуры с запрашиваемым товаром с учётом записанных.
7. Затестить.
 
Последовательность действий 2-го варианта:
1. Для контроля Заказа необходимо создать регистр накоплений ЗаказПокупателя с видом: Остатки.
2. Создать док ЗаказПокупателя, где будет заполнятся только Номенклатура и Кол-во.
3. В Приходной и Расходной в зависимости от условия задачи засунуть ЗаказПокупателя как ссылку на док.
4. При формировании движений в Приходной накладной нужно по новой методике добавить записи в остатки регистра заказов, сравнить остатки Заказа с временной таблицей втТЧТовары, если меньше 0, тогда отказ, иначе записываем движения в ОстаткиНоменклатуры.
5. Затем в Расходной накладной нужно по старой методике сравнить ОстаткиНоменклатуры с запрашиваемым товаром с учётом записанных.
6. Затестить.
 
# Подробная логика решения по ОУ
## ОУ 1
### Постановка задачи
**Ключевые слова:** услуги в ТЧ, разрез складов в шапке дока, себестоимость по партиям FIFO/LIFO, учетная политика раз в год, расчет себестоимости в разрезе ВСЕЙ компании.

    Остатки товаров на 01.01.2010
| **Склад**  | **Номенклатура** | **Кол-во** | 
|:----------:|:----------------:|:----------:|
| Основной   |                  |            |
|            | Куртка замшевая  | 2          |
|            | Портсигар        | 2          |
| Транзитный |                  |            |
|            | Куртка замшевая  | 5          |
|            | Кинокамера       | 1          |
### Решение
#### Услуги в ТЧ
- *Спр:Номенклатура* добавить *ВидНоменклатуры = Перечисление.ВидНоменклатуры*.
- Проверка на заполнение: Выдавать ошибку.
- Проставить тестируемым товарам и услугам *Вид*.
#### Разрез складов в шапке дока
- Добавить *Спр:Склад*.
- Добавить в *Приходной* и *Расходной* реквизит *Склад* *Спр:Склад*.
- Добавить в *ОстаткиНоменклатуры* измерение *Склад*.
#### Учетная политика раз в год
- Создать *РегСвед:УчетнаяПолитика* с ресурсом *МетодУчетнойПолитики* с периодичность в 1 год.
#### Себестоимость по партиям FIFO/LIFO И Расчет себестоимости в разрезе ВСЕЙ компании
- В расходной выполнить запрос с *Итогами* по *Номенклатуре* и выбрать *ПоГруппировкам* без учета *Склада* с *УБЫВ*.
- Списать по формуле $Себестоимость = КолвоСписание * ИтогСумма / ИтогКолво$. При полном списании $Себестоимость = Сумма$.
- Поставить условие на *ФИФО* и изменить текст запроса на *ВОЗР*.

## ОУ 2
### Постановка задачи
**Ключевые слова:** услуги в ТЧ, ТЧ Расходной имеет партию, проверка только по текущей партии.

    Продажи с 01.01.2010 по 31.03.2010
| **Номенклатура** | **Кол-во** | **Себест-стъ** | **Продажа** | **Прибыль** | **Интервал** | **Срок** |
|:----------------:|:----------:|:--------------:|:-----------:|:-----------:|:------------:|:--------:|
| Куртка замшевая  | 3          | 300            | 620         | 320         | 10           | 20       |
| Портсигар        | 3          | 30             | 50          | 20          | Разовая      | 50       |
| Доставка         | 1          |                | 100         | 100         | Разовая      |          |
### Решение
#### Услуги в ТЧ
- Спр:Номенклатура добавить *ВидНоменклатуры = Перечисление.ВидНоменклатуры*.
- Проверка на заполнение: Выдавать ошибку.
- Проставить тестируемым товарам и услугам *Вид*.
#### ТЧ Расходной имеет партию, проверка только по текущей партии
- Добавить в ТЧ Расходной реквизит *Партия = Ссылка* на Приходную.
- В расходной выполнить запрос на наличие Номенклатуры в указанной партии.
#### Подготовка конфигурации к отчёту
- Создание регистра накопления *Продажи* с измерением *Номенклатура*, ресурсами: *Кол-во, Себестомость, Продажа*
- Реализовать движение по *Расходной* (все данные должны быть в запросе)

## ОУ 3
### Постановка задачи
**Ключевые слова:** 

### Решение
#### 
